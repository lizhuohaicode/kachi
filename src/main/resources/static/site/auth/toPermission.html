<!DOCTYPE html>
<html>
  <head>
    <title>指定卡管理</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
	<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
	<link rel="stylesheet" type="text/css" href="../../css/easyui/themes/default/easyui.css" rel="stylesheet" title="blue"/>
	<link rel="stylesheet" type="text/css" href="../../css/easyui/themes/icon.css"/>
	<script type="text/javascript" src="../../js/jquery-1.6.3.min.js"></script>
	<script type="text/javascript" src="../../js/jquery.easyui.min.js"></script>
	<script type="text/javascript" src="../../js/easyui-lang-zh_CN.js"></script>
	<script type="text/javascript" src="../../js/common.js"></script>
  </head>
  <body>
  	<ul id="tt"></ul>
  </body>
  <script type="text/javascript">
	  $(function(){
	  	$.post(kcJs.fn.getContextPath()+'/getPermissionTree',function(data){
	  		data = changeData(data)
	  		if(data){
	  			$('#tt').tree({
				    data:data,
				    checkbox:true,
				    onClick:function(node){
				    	
				    }
				});
	  		}
	  	},'json');
	  });
	  
	  function changeData(data){
	  	for(var i = 0;i<data.length;i++){
	  		change(data[i]);
	  	}
	  	return data;
	  }
	  
	  function change(data){
	  	if(data && data.children){
	  		if(data.attributes.isMenu){
	  			data.state="closed";
	  		}
	  		data.iconCls="";
	  		for(var i = 0; i < data.children.length;i++){
	  			var obj = data.children[i];
	  			if(obj.children && obj.children.length>0){
	  				change(obj);
	  			}else{
	  				delete obj.children;
	  				obj.iconCls="";
	  			}
	  		}
	  	}
	  }
  </script>
</html>	